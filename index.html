<!DOCTYPE html>
<html lang="en" dir="auto">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>ุณุจุงู ุงูุชุชุงุจุน ุงูุชุนูููู - Relay Race Quiz</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&family=Segoe+UI:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Fireworks Canvas -->
    <canvas id="fireworksCanvas"></canvas>

    <!-- Language Switcher -->
    <div id="languageSwitcher" class="language-switcher">
        <button id="btnLangAr" class="lang-btn active">ุงูุนุฑุจูุฉ</button>
        <button id="btnLangEn" class="lang-btn">English</button>
    </div>

    <!-- Main Menu -->
    <div id="mainMenu" class="screen">
        <h1 data-key="gameTitle">๐โโ๏ธ ุณุจุงู ุงูุชุชุงุจุน ุงูุชุนูููู</h1>
        <div class="menu-buttons">
            <button id="btnNewGame" class="menu-btn" data-key="newGame">ูุนุจุฉ ุฌุฏูุฏุฉ</button>
            <button id="btnManageQuestions" class="menu-btn" data-key="manageQuestions">ุฅุฏุงุฑุฉ ูููุงุช ุงูุฃุณุฆูุฉ</button>
            <button id="btnInstructions" class="menu-btn" data-key="instructions">ุชุนูููุงุช ุงููุนุจ</button>
        </div>
    </div>

    <!-- Question File Management Screen -->
    <div id="fileManager" class="screen hidden">
        <h2 data-key="fileManagerTitle">ูุฏูุฑ ุงููููุงุช</h2>
        <div class="file-section">
            <h3 data-key="uploadNewFile">ุฑูุน ููู ุฌุฏูุฏ</h3>
            <div class="upload-area">
                <select id="fileTypeSelect" style="padding: 15px; border-radius: 10px; border: none; background: white; cursor: pointer;">
                    <option value="questions" data-key="fileTypeQuestion">ููู ุฃุณุฆูุฉ</option>
                    <option value="class" data-key="fileTypeClass">ููู ูุตู</option>
                </select>
                <input type="file" id="fileInput" accept=".json,.csv,.txt">
                <button id="btnUpload" data-key="upload">ุฑูุน</button>
            </div>
            <div class="file-format-help">
                <p data-key="supportedFormats">ุงูุตูุบ ุงููุฏุนููุฉ: JSON, CSV, TXT</p>
                <p style="margin-top: 10px; font-size: 0.85em; color: rgba(255,255,255,0.6);">
                    <strong>ููู ุงููุตู:</strong> ูุฌุจ ุฃู ูุญุชูู ุนูู ุฃุณูุงุก ุงููุฑู ูุงูุทูุงุจ. ุงูุตูุบ: Team,Student (CSV) ุฃู Team: Name / - Student (TXT)
                </p>
            </div>
        </div>
        <div class="file-section">
            <div id="fileList" class="file-list"></div>
        </div>
        <button id="btnBackToMenu" class="back-btn" data-key="backToMenu">ุงูุนูุฏุฉ ูููุงุฆูุฉ</button>
    </div>

    <!-- Game Setup Screen -->
    <div id="gameSetup" class="screen hidden">
        <h2 data-key="gameSetupTitle">ุฅุนุฏุงุฏ ุงููุนุจุฉ</h2>
        <div class="setup-section">
            <label data-key="selectQuestionFile">ุงุฎุชุฑ ููู ุงูุฃุณุฆูุฉ:</label>
            <select id="questionFileSelect"></select>
        </div>
        <div class="setup-section">
            <label data-key="selectClassFile">ุงุฎุชุฑ ููู ุงููุตู (ุงุฎุชูุงุฑู):</label>
            <select id="classFileSelect">
                <option value="" data-key="noClassFile">ุจุฏูู ููู ูุตู</option>
            </select>
        </div>
        <div class="setup-section">
            <label data-key="numberOfTeams">ุนุฏุฏ ุงููุฑู:</label>
            <select id="teamCount">
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4" selected>4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select>
        </div>
        <div class="setup-section">
            <label data-key="studentsPerTeam">ุนุฏุฏ ุงูุทูุงุจ ูู ูู ูุฑูู:</label>
            <select id="studentsPerTeam">
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4" selected>4</option>
                <option value="5">5</option>
                <option value="6">6</option>
            </select>
        </div>
        <div class="setup-section">
            <label data-key="trackLength">ุทูู ุงููุถูุงุฑ (ููุงุช):</label>
            <select id="trackLaps">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4" selected>4</option>
            </select>
        </div>
        <div id="teamNames" class="team-names"></div>
        <button id="btnStartGame" class="start-btn" data-key="startGame">ุจุฏุก ุงููุนุจุฉ</button>
        <button id="btnCancelSetup" class="back-btn" data-key="cancel">ุฅูุบุงุก</button>
    </div>

    <!-- Game Screen -->
    <div id="gameScreen" class="screen hidden">
        <div class="game-header">
            <div id="lapInfo" class="lap-info">ุงูููุฉ 1 ูู 4</div>
            <div class="game-title-small" data-key="gameTitle">ุณุจุงู ุงูุชุชุงุจุน ุงูุชุนูููู</div>
            <button id="btnPause" class="pause-btn" data-key="pause">ุฅููุงู ูุคูุช</button>
        </div>
        
        <canvas id="gameCanvas"></canvas>
        
        <!-- Multiple question panels for simultaneous answering -->
        <div id="questionPanels" class="question-panels-container"></div>
        
        <div id="countdown" class="countdown hidden">3</div>
        
        <!-- Waiting overlay for teams that answered while others are still answering -->
        <div id="waitingOverlay" class="waiting-overlay hidden">
            <div class="waiting-content">
                <h3 data-key="waitingForOthers">ูู ุงูุชุธุงุฑ ุงููุฑู ุงูุฃุฎุฑู...</h3>
                <div class="spinner"></div>
            </div>
        </div>
    </div>

    <!-- Pause Menu -->
    <div id="pauseMenu" class="overlay hidden">
        <div class="pause-content">
            <h2 data-key="gamePaused">ุงููุนุจุฉ ูุชูููุฉ</h2>
            <button id="btnResume" data-key="resume">ุงุณุชุฆูุงู</button>
            <button id="btnRestart" data-key="restart">ุฅุนุงุฏุฉ ุงููุนุจุฉ</button>
            <button id="btnQuitToMenu" data-key="quitToMenu">ุงูุฎุฑูุฌ ูููุงุฆูุฉ</button>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="resultsScreen" class="screen results-screen hidden">
        <h2 data-key="raceResults">๐ ูุชุงุฆุฌ ุงูุณุจุงู</h2>
        <div id="resultsList" class="results-list"></div>
        <div class="results-buttons">
            <button id="btnDownloadReport" class="menu-btn" data-key="downloadReport">ุชุญููู ุงูุชูุฑูุฑ</button>
            <button id="btnNewGameFromResults" class="menu-btn" data-key="newGameBtn">ูุนุจุฉ ุฌุฏูุฏุฉ</button>
            <button id="btnBackToMenuFromResults" class="back-btn" data-key="mainMenuBtn">ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ</button>
        </div>
    </div>

    <!-- Instructions Screen -->
    <div id="instructionsScreen" class="screen hidden">
        <h2 data-key="howToPlay">ููููุฉ ุงููุนุจ</h2>
        <div class="instructions">
            <p data-key="instruction1">1. ูุณู ุงูุทูุงุจ ุฅูู ูุฑู</p>
            <p data-key="instruction2">2. ูู ุทุงูุจ ูุชุญูู ูู ุนุฏูุงุก ูุงุญุฏ</p>
            <p data-key="instruction3">3. ุฃุฌุจ ุนูู ุงูุฃุณุฆูุฉ ุจุดูู ุตุญูุญ ููุฑูุถ ุจุณุฑุนุฉ ุฃูุจุฑ</p>
            <p data-key="instruction4">4. ุงูุฅุฌุงุจุงุช ุงูุฎุงุทุฆุฉ ุชุจุทุฆู</p>
            <p data-key="instruction5">5. ูุฑูุฑ ุงูุนุตุง ุจุนุฏ ูู ููุฉ</p>
            <p data-key="instruction6">6. ุฃูู ูุฑูู ููุชูู ูููุฒ!</p>
        </div>
        <button id="btnBackFromInstructions" class="back-btn" data-key="back">ุฑุฌูุน</button>
    </div>

    <script src="game.js"></script>
</body>
</html>
